<div class="task-list-container">
  <h2 class="title">Task Manager</h2>

  <div class="add-task-section">
    <input
      type="text"
      [(ngModel)]="newTaskDescription"
      placeholder="Enter a new task..."
      class="task-input"
      (keyup.enter)="addNewTask()"
    />
    <button (click)="addNewTask()" class="btn add-btn">Add Task</button>
  </div>

  <div class="filter-section">
    <h3>Filter Tasks</h3>
    <div class="filter-buttons">
      <button
        (click)="applyFilter('all')"
        [class.active]="currentFilterStatus === 'all'"
      >All ({{ totalTaskCount }})</button>

      <button
        (click)="applyFilter('pending')"
        [class.active]="currentFilterStatus === 'pending'"
      >Pending ({{ pendingTaskCount }})</button>

      <button
        (click)="applyFilter('completed')"
        [class.active]="currentFilterStatus === 'completed'"
      >Completed ({{ completedTaskCount }})</button>
    </div>
  </div>

  <ul class="task-list">
    <li *ngFor="let task of visibleTasks; trackBy: trackByTaskId" class="task-item" [class.completed]="task.isCompleted">

      <input
        type="checkbox"
        [checked]="task.isCompleted"
        (change)="toggleTaskCompletion(task.id)"
      />

      <span *ngIf="activeEditTaskId !== task.id" (dblclick)="startTaskEditing(task)">
        {{ task.description }}
      </span>

      <input
        *ngIf="activeEditTaskId === task.id"
        [(ngModel)]="activeEditTaskDescription"
        (keydown)="handleKeyDown($event, task)"
        class="edit-input"
        placeholder="Edit task..."
        autofocus
      />

      <div class="task-actions">
        <button *ngIf="activeEditTaskId === task.id" (click)="confirmTaskEditing(task)" class="btn save-btn">Save</button>
        <button (click)="removeTaskById(task.id)" class="btn delete-btn">Delete</button>
      </div>
    </li>
  </ul>

  <div class="stats-section">
    <p><strong>Total Tasks:</strong> {{ totalTaskCount }}</p>
    <p><strong>Completed:</strong> {{ completedTaskCount }}</p>
    <p><strong>Pending:</strong> {{ pendingTaskCount }}</p>
  </div>
</div>
